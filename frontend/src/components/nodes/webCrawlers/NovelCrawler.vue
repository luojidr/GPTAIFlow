<script>
export const male_list = [{"label": "全部分类","value": "全部分类"},{"label": "玄幻","value": "玄幻"},{"label": "奇幻","value": "奇幻"},{"label": "仙侠","value": "仙侠"},{"label": "都市","value": "都市"},{"label": "现实","value": "现实"},{"label": "军事","value": "军事"},{"label": "历史","value": "历史"},{"label": "游戏","value": "游戏"},{"label": "体育","value": "体育"},{"label": "科幻","value": "科幻"},{"label": "诸天无限","value": "诸天无限"},{"label": "悬疑","value": "悬疑"},{"label": "轻小说","value": "轻小说"},{"label": "VIP新作","value": "VIP新作"}]
export const female_list = [{"label": "全部","value": "全部"}, {"label": "古代言情","value": "古代言情"}, {"label": "仙侠奇缘","value": "仙侠奇缘"}, {"label": "现代言情","value": "现代言情"}, {"label": "浪漫青春","value": "浪漫青春"}, {"label": "玄幻言情","value": "玄幻言情"}, {"label": "悬疑推理","value": "悬疑推理"}, {"label": "科幻空间","value": "科幻空间"}, {"label": "游戏竞技","value": "游戏竞技"}]
export const female_yuepiao_list = [{"label": "全部","value": "全部"}, {"label": "古言分类榜","value": "古言分类榜"}, {"label": "现言分类榜","value": "现言分类榜"},{"label": "幻言分类榜","value": "幻言分类榜"} ,{"label": "VIP新作","value": "VIP新作"}]
export const fq_pinnacle_list = [{"label": "阅读榜","value": "阅读榜",},{"label": "新书榜","value": "新书榜",}]
export const fq_male_list = [{"label": "科幻末世","value": "科幻末世", "children": fq_pinnacle_list},{"label": "都市日常","value": "都市日常", "children": fq_pinnacle_list},{"label": "都市修真","value": "都市修真", "children": fq_pinnacle_list},{"label": "都市高武", "value": "都市高武", "children": fq_pinnacle_list},{"label": "奇幻仙侠","value": "奇幻仙侠", "children": fq_pinnacle_list},{"label": "历史古代","value": "历史古代", "children": fq_pinnacle_list},{"label": "战神赘婿","value": "战神赘婿", "children": fq_pinnacle_list},{"label": "都市种田","value": "都市种田", "children": fq_pinnacle_list},{"label": "传统玄幻","value": "传统玄幻", "children": fq_pinnacle_list},{"label": "历史脑洞","value": "历史脑洞", "children": fq_pinnacle_list},{"label": "悬疑脑洞","value": "悬疑脑洞", "children": fq_pinnacle_list},{"label": "都市脑洞","value": "都市脑洞", "children": fq_pinnacle_list},{"label": "玄幻脑洞","value": "玄幻脑洞", "children": fq_pinnacle_list},{"label": "悬疑灵异","value": "悬疑灵异", "children": fq_pinnacle_list},{"label": "抗战谍战","value": "抗战谍战", "children": fq_pinnacle_list},{"label": "游戏体育","value": "游戏体育", "children": fq_pinnacle_list},{"label": "动漫衍生","value": "动漫衍生", "children": fq_pinnacle_list},{"label": "男频衍生","value": "男频衍生", "children": fq_pinnacle_list}]
export const fq_female_list = [{"label": "女频衍生","value": "女频衍生", "children": fq_pinnacle_list},{"label": "玄幻言情","value": "玄幻言情", "children": fq_pinnacle_list},{"label": "种田","value": "种田", "children": fq_pinnacle_list},{"label": "年代", "value": "年代", "children": fq_pinnacle_list},{"label": "现言脑洞","value": "现言脑洞", "children": fq_pinnacle_list},{"label": "宫斗宅斗","value": "宫斗宅斗", "children": fq_pinnacle_list},{"label": "悬疑脑洞","value": "悬疑脑洞", "children": fq_pinnacle_list},{"label": "古言脑洞","value": "古言脑洞", "children": fq_pinnacle_list},{"label": "医术","value": "医术", "children": fq_pinnacle_list},{"label": "快穿","value": "快穿", "children": fq_pinnacle_list},{"label": "青春甜宠","value": "青春甜宠", "children": fq_pinnacle_list},{"label": "星光璀璨","value": "星光璀璨", "children": fq_pinnacle_list},{"label": "悬疑恋爱","value": "悬疑恋爱", "children": fq_pinnacle_list},{"label": "职场婚恋","value": "职场婚恋", "children": fq_pinnacle_list},{"label": "豪门总裁","value": "豪门总裁", "children": fq_pinnacle_list},{"label": "民国言情","value": "民国言情", "children": fq_pinnacle_list}]
export const db_list = [{"label": "原创", "value": "原创", "children": [{"label": "连载榜", "value": "连载榜"}, {"label": "潜力榜", "value": "潜力榜"}, {"label": "畅销榜", "value": "畅销榜", "children": [{"label": "周榜", "value": "周榜"}, {"label": "月榜", "value": "月榜"}, {"label": "总榜", "value": "总榜"}]}, {"label": "新人榜", "value": "新人榜"}, {"label": "完本榜", "value": "完本榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}, {"label": "推荐票榜", "value": "推荐票榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}, {"label": "会员榜", "value": "会员榜"}, {"label": "中篇榜", "value": "中篇榜"}]}, {"label":"悬疑", "value":"悬疑", "children": [{"label": "连载榜", "value": "连载榜"}, {"label": "畅销榜", "value": "畅销榜", "children": [{"label": "周榜", "value": "周榜"}, {"label": "月榜", "value": "月榜"}, {"label": "总榜", "value": "总榜"}]}, {"label": "完本榜", "value": "完本榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}, {"label": "推荐票榜", "value": "推荐票榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}]}, {"label":"言情", "value":"言情", "children": [{"label": "连载榜", "value": "连载榜"}, {"label": "畅销榜", "value": "畅销榜", "children": [{"label": "周榜", "value": "周榜"}, {"label": "月榜", "value": "月榜"}, {"label": "总榜", "value": "总榜"}]}, {"label": "完本榜", "value": "完本榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}, {"label": "推荐票榜", "value": "推荐票榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}]}, {"label":"女性", "value":"女性", "children": [{"label": "连载榜", "value": "连载榜"}, {"label": "畅销榜", "value": "畅销榜", "children": [{"label": "周榜", "value": "周榜"}, {"label": "月榜", "value": "月榜"}, {"label": "总榜", "value": "总榜"}]}, {"label": "完本榜", "value": "完本榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}, {"label": "推荐票榜", "value": "推荐票榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}]}, {"label":"幻想", "value":"幻想", "children": [{"label": "连载榜", "value": "连载榜"}, {"label": "畅销榜", "value": "畅销榜", "children": [{"label": "周榜", "value": "周榜"}, {"label": "月榜", "value": "月榜"}, {"label": "总榜", "value": "总榜"}]}, {"label": "完本榜", "value": "完本榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}, {"label": "推荐票榜", "value": "推荐票榜", "children": [{"label": "月榜", "value": "月榜"}, {"label": "季榜", "value": "季榜"}, {"label": "年榜", "value": "年榜"}]}]}, {"label": "同人", "value": "同人", "children": [{"label": "热度榜", "value": "热度榜"}, {"label": "连载榜", "value": "连载榜"},{"label": "热评榜", "value": "热评榜"}, {"label": "上升榜", "value": "上升榜"}]}, {"label": "文艺", "value":"文艺", "children":[{"label": "连载榜", "value":"连载榜"}, {"label": "完本榜", "value":"完本榜", "children": [{"label": "月榜", "value":"月榜"},{"label": "季榜", "value":"季榜"}, {"label": "年榜", "value":"年榜"}]}]}, {"label": "出版", "value":"出版", "children":[{"label": "畅销榜", "value":"畅销榜"},{"label": "新书榜", "value":"新书榜"},{"label": "会员榜", "value":"会员榜"},{"label": "套装榜", "value":"套装榜"}, {"label": "好评榜", "value":"好评榜"}]}]
</script>

<script setup>
import { ref } from 'vue'
import { useI18n } from 'vue-i18n'
import BaseNode from '@/components/nodes/BaseNode.vue'
import BaseField from '@/components/nodes/BaseField.vue'


const props = defineProps({
  id: {
    type: String,
    required: true,
  },
  data: {
    type: Object,
    required: true,
  },
  templateData: {
    "description": "description",
    "task_name": "web_crawlers.fanqie_crawler",
    "has_inputs": true,
    "template": {
      "rankOptions": {
        "required": false,
        "placeholder": "",
        "show": true,
        "vShow": false,
        "multiline": false,
        'mode': "multiple",
        "value":  [],
        "password": false,
        "options": [
          {
            "label": "男频排行榜",
            "value": "男频排行榜",
            "children": fq_male_list
          },
          {
            "label": "女频排行榜",
            "value": "女频排行榜",
            "children": fq_female_list
          },
          {
            "label": "番茄巅峰榜",
            "value": "番茄巅峰榜",
          },
        ],
        "name": "rankOptions",
        "display_name": "rankOptions",
        "type": "str",
        "clear_after_run": false,
        "list": false,
        "field_type": "cascader",
      },
      "websiteType": {
        "required": true,
        "placeholder": "",
        "show": true,
        "multiline": false,
        "value":  [],
        "password": false,
        "options": [
          {
            "label": "番茄小说",
            "value": "番茄小说",
          },
          {
          "label": "起点小说",
          "value": "起点小说",
          },
          {
          "label": "豆瓣小说",
          "value": "豆瓣小说",
          }
        ],
        "name": "websiteType",
        "display_name": "websiteType",
        "type": "str",
        "clear_after_run": false,
        "list": false,
        "field_type": "select"
      },
      "qdSexOptions": {
        "required": true,
        "placeholder": "",
        "vShow": false,
        "show": true,
        "multiline": false,
        "value":  [],
        "password": false,
        "options": [
          {
            "label": "男频排行榜",
            "value": "男频排行榜",
            "children": [
              {
                "label": "月票榜",
                "value": "月票榜",
                "children": male_list
              },
              {
                "label": "畅销榜",
                "value": "畅销榜",
                "children": male_list
              },
              {
                "label": "阅读指数榜",
                "value": "阅读指数榜",
                "children": male_list
              },
              {
                "label": "书友榜",
                "value": "书友榜",
                "children": male_list
              },
              {
                "label": "推荐榜",
                "value": "推荐榜",
                "children": male_list
              },
              {
                "label": "收藏榜",
                "value": "收藏榜",
                "children": male_list
              },
              {
                "label": "更新榜",
                "value": "更新榜",
                "children": male_list
              },
            ]
          },
          {
          "label": "女频排行榜",
          "value": "女频排行榜",
          "children": [
              {
                "label": "月票榜",
                "value": "月票榜",
                "children": female_yuepiao_list
              },
              {
                "label": "新书热销榜",
                "value": "新书热销榜",
                "children": [
                  {
                    "label": "全部",
                    "value": "全部"
                    
                  }
                ]
              },
              {
                "label": "阅读指数榜",
                "value": "阅读指数榜",
                "children": female_list
              },
              {
                "label": "畅销榜",
                "value": "畅销榜",
                "children": [
                  {
                    "label": "全部",
                    "value": "全部"
                    
                  }
                ]
              },
              {
                "label": "书友榜",
                "value": "书友榜",
                "children": female_list
              },
              {
                "label": "热门单订榜",
                "value": "热门单订榜",
                "children": [
                  {
                    "label": "全部",
                    "value": "全部"
                    
                  }
                ]
              },
              {
                "label": "推荐榜",
                "value": "推荐榜",
                "children": female_list
              },
              {
                "label": "收藏榜",
                "value": "收藏榜",
                "children": female_list
              },
            ]
          }
        ],
        "name": "qdSexOptions",
        "display_name": "qdSexOptions",
        "type": "bool",
        "clear_after_run": false,
        "list": false,
        "field_type": "cascader"
      },
      "dbListType": {
        "required": true,
        "placeholder": "",
        "vShow": false,
        "show": true,
        "multiline": false,
        "value":  [],
        "password": false,
        "options": db_list,
        "name": "dbListType",
        "display_name": "dbListType",
        "type": "bool",
        "clear_after_run": false,
        "list": false,
        "field_type": "cascader"
      },
      "prompt": {
        "required": true,
        "placeholder": "",
        "show": true,
        "multiline": true,
        "value": "",
        "password": false,
        "name": "prompt",
        "display_name": "prompt",
        "type": "str",
        "clear_after_run": true,
        "list": false,
        "field_type": "number"
      },
      "origin_content_output": {
        "required": true,
        "placeholder": "",
        "show": false,
        "multiline": true,
        "value": "",
        "password": false,
        "name": "origin_content_output",
        "display_name": "origin_content_output",
        "type": "str",
        "clear_after_run": true,
        "list": false,
        "field_type": ""
      },
      "output": {
        "required": true,
        "placeholder": "",
        "show": false,
        "multiline": true,
        "value": "",
        "password": false,
        "name": "output",
        "display_name": "output",
        "type": "str",
        "clear_after_run": true,
        "list": false,
        "field_type": ""
      }
    },
  }
})

const { t } = useI18n()

const fieldsData = ref(props.data.template)


// 监听排行榜选项的变化，以更新小说类型选项
const updateGenresOptions = (rank) => {
  if (rank.length==1) {
    fieldsData.value.genresOptions.options = Object.values(fieldsData.value.rankOptions.options[0].genres)
  } else if (rank.length > 1) {
    fieldsData.value.genresOptions.options = [...Object.values(fieldsData.value.rankOptions.options[0].genres), ...Object.values(fieldsData.value.rankOptions.options[1].genres)];
  } 
  else {
    fieldsData.value.genresOptions.options = []
  }
}

const updateWebsiteType = (websiteTypeValue) => {
  const fqshouldShow = websiteTypeValue === '番茄小说';
  const qdshouldShow = websiteTypeValue === '起点小说';
  const dbshouldShow = websiteTypeValue === '豆瓣小说';
  fieldsData.value.rankOptions.vShow = fqshouldShow;
  fieldsData.value.qdSexOptions.vShow = qdshouldShow;
  fieldsData.value.dbListType.vShow = dbshouldShow;
};



</script>

<template>
  <BaseNode :nodeId="id" :title="t('components.nodes.webCrawlers.NovelCrawler.title')" :description="t('components.nodes.webCrawlers.NovelCrawler.description')">
    <template #main>
      <a-row type="flex">
        <a-col :span="24">
          <BaseField id="websiteType" :name="t('components.nodes.webCrawlers.NovelCrawler.websiteType')" type="target" v-model:show="fieldsData.websiteType.show">
            <a-select v-model="fieldsData.websiteType.options" @change="updateWebsiteType" style="width: 100%;" allowClear>
              <a-select-option v-for="(option, key) in fieldsData.websiteType.options" :key="key" :value="option.value">{{ option.label }}</a-select-option>
            </a-select>
          </BaseField>
        </a-col>
        <a-col :span="24">
          <BaseField id="qdSexOptions" :name="t('components.nodes.webCrawlers.NovelCrawler.qdSexOptions')" type="target" v-model:show="fieldsData.qdSexOptions.show" v-show="fieldsData.qdSexOptions.vShow">
            <a-cascader v-model:value="fieldsData.qdSexOptions.value" :options="fieldsData.qdSexOptions.options" style="width: 100%;"></a-cascader>
          </BaseField>
        </a-col>
        <a-col :span="24">
          <BaseField id="rankOptions" :name="t('components.nodes.webCrawlers.NovelCrawler.rankOptions')" type="target" v-model:show="fieldsData.rankOptions.show" v-show="fieldsData.rankOptions.vShow">
            <a-cascader v-model:value="fieldsData.rankOptions.value" :options="fieldsData.rankOptions.options" style="width: 100%;"></a-cascader>
          </BaseField>
        </a-col>
        <a-col :span="24">
          <BaseField id="dbListType" :name="t('components.nodes.webCrawlers.NovelCrawler.dbListType')" type="target" v-model:show="fieldsData.dbListType.show" v-show="fieldsData.dbListType.vShow">
            <a-cascader v-model:value="fieldsData.dbListType.value" :options="fieldsData.dbListType.options" style="width: 100%;"></a-cascader>
          </BaseField>
        </a-col>
        <a-col :span="24">
          <BaseField id="prompt" :name="t('components.nodes.webCrawlers.NovelCrawler.prompt')" type="target"
            v-model:show="fieldsData.prompt.show">
            <a-input-number v-model:value="fieldsData.prompt.value" :placeholder="fieldsData.prompt.placeholder" />
          </BaseField>
        </a-col>
      </a-row>
    </template>
    <template #output>
      <a-row type="flex" style="width: 100%;">
        <a-col :span="24">
          <BaseField id="origin_content_output" :name="t('components.nodes.webCrawlers.NovelCrawler.origin_content_output')" type="source" nameOnly>
      </BaseField>
        </a-col>
        <a-col :span="24">
          <BaseField id="output" :name="t('components.nodes.webCrawlers.NovelCrawler.output')" type="source" nameOnly>
      </BaseField>
        </a-col>
      </a-row>
    </template>
  </BaseNode>
</template>

<style scoped>
/* 在这里添加你的样式 */
</style>
